<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>BadgeR by csongradyp</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">BadgeR</h1>
        <p class="header">Achievement engine with annotation support</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/csongradyp/badgeR/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/csongradyp/badgeR/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/csongradyp/badgeR">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/csongradyp">csongradyp</a></p>


      </header>
      <section>
        <h1>
<a id="badger-achievement-engine-" class="anchor" href="#badger-achievement-engine-" aria-hidden="true"><span class="octicon octicon-link"></span></a>BadgeR achievement engine <img src="https://dl.dropboxusercontent.com/u/6057082/BagdeR_icon.png" alt="Image of BadgeR">
</h1>

<p><a href="https://travis-ci.org/csongradyp/badgeR"><img src="https://travis-ci.org/csongradyp/badgeR.svg" alt="Build Status"></a>
<a href="https://coveralls.io/r/csongradyp/badgeR?branch=master"><img src="https://coveralls.io/repos/csongradyp/badgeR/badge.svg?branch=master" alt="Coverage Status"></a></p>

<h4>
<a id="keep-the-codebase-clean-by-separating-achievement-handling-from-your-code" class="anchor" href="#keep-the-codebase-clean-by-separating-achievement-handling-from-your-code" aria-hidden="true"><span class="octicon octicon-link"></span></a><em>Keep the codebase clean by separating achievement handling from your code.</em>
</h4>

<ul>
<li>You can separate achievement operations from production code with annotations</li>
<li>It needs only one *.json or *.ini file for achievement declaration</li>
<li>Supports internationalization (i18n)</li>
</ul>

<h2>
<a id="features" class="anchor" href="#features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Features</h2>

<h4>
<a id="1-annotation-support" class="anchor" href="#1-annotation-support" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Annotation support</h4>

<p>You can avoid mixing the achievement related codes with the real functional codes.</p>

<table>
<thead>
<tr>
<th align="left">Annotation</th>
<th align="left">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>@AchievementEventTrigger</code></td>
<td align="left">Triggers a defined event by incrementing the event counter by one and checks for possible unlocked achievements</td>
</tr>
<tr>
<td align="left"><code>@AchievementScore</code></td>
<td align="left">Triggers a defined event by setting the event counter by the given score and checks for possible unlocked achievements</td>
</tr>
<tr>
<td align="left"><code>@AchievementUnlock</code></td>
<td align="left">Unlock achievement manually</td>
</tr>
<tr>
<td align="left"><code>@AchievementCheck</code></td>
<td align="left">Checks for possible unlocked achievements</td>
</tr>
</tbody>
</table>

<h4>
<a id="2-easy-achievement-declaration" class="anchor" href="#2-easy-achievement-declaration" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Easy achievement declaration</h4>

<p>Achievements can be given with a single <strong>*.ini</strong> or <strong>*.json</strong> file.
There are only few conventions to follow:</p>

<ol>
<li>Achievements should have a unique id</li>
<li>Achievements should belong to one type</li>
</ol>

<h5>
<a id="21-json-definition" class="anchor" href="#21-json-definition" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.1 Json definition</h5>

<p><a href="JSON.md">Define achievement in JSon format</a></p>

<h5>
<a id="21-ini-definition" class="anchor" href="#21-ini-definition" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.1 Ini definition</h5>

<p><a href="INI.md">Define achievement in Ini format</a></p>

<p>Achievement properties:</p>

<ul>
<li>id</li>
<li>subscription</li>
<li>trigger</li>
<li>category</li>
</ul>

<p>There are 6 predefined achievement types which can be used to define a the unlock behavior of the achievement:</p>

<table>
<thead>
<tr>
<th align="center">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><strong>single</strong></td>
<td align="left">Achievement with no triggers, can be unlocked only directly.</td>
</tr>
<tr>
<td align="center"><strong>score</strong></td>
<td align="left">Unlocked when one of the subscribed event counter scores are meeting trigger requirements</td>
</tr>
<tr>
<td align="center"><strong>scoreRange</strong></td>
<td align="left">Unlocked when one of the subscribed event counter scores are within defined score range</td>
</tr>
<tr>
<td align="center"><strong>date</strong></td>
<td align="left">Unlocked when one of the given events are triggered one of the given days</td>
</tr>
<tr>
<td align="center"><strong>time</strong></td>
<td align="left">Unlocked when one of the given events are triggered within the given minutes</td>
</tr>
<tr>
<td align="center"><strong>timeRange</strong></td>
<td align="left">Unlocked when one of the given events are triggered within the given time ranges</td>
</tr>
</tbody>
</table>

<h4>
<a id="3-get-notified-of-unlocked-achievements-or-updated-events" class="anchor" href="#3-get-notified-of-unlocked-achievements-or-updated-events" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Get notified of unlocked achievements or updated events</h4>

<p>Badger will notify every time when an achievement is unlocked or an  event counter is updated.</p>

<p>To subscribe just implement a handler and pass is to Badger. See more at usage section.</p>

<h1>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h1>

<h2>
<a id="1--achievement-definition" class="anchor" href="#1--achievement-definition" aria-hidden="true"><span class="octicon octicon-link"></span></a>1.  Achievement definition</h2>

<p>Achievement can be defined in two formats: JSON or INI.</p>

<h2>
<a id="2-internationalization-localization-i18n" class="anchor" href="#2-internationalization-localization-i18n" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Internationalization, localization (i18n)</h2>

<p>There is an option to get i18n messages for unlocked achievements. Just create the i18n message *.properties and give the base name to Badger.
For i18n message properties files find some examples <a href="https://docs.oracle.com/javase/tutorial/i18n/intro/steps.html">here</a></p>

<h4>
<a id="21-localization-keys" class="anchor" href="#21-localization-keys" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.1 localization keys</h4>

<p>To let BangeR give you the resolved messages in the achievement information you should follow the following naming convention:</p>

<ul>
<li>Achievement title key is: <strong><em>[ID]</em>.title</strong>
</li>
<li>Achievement description key is: <strong><em>[ID]</em>.text</strong>
</li>
</ul>

<p>BadgeR's locale can be changed at any time or just let it to use the default locale of your JVM.</p>

<p>Without adding i18n basename Badger will pass the keys as value.</p>

<h2>
<a id="3-wire-into-code" class="anchor" href="#3-wire-into-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Wire into code</h2>

<h4>
<a id="31-instantiate-badger" class="anchor" href="#31-instantiate-badger" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.1 Instantiate BadgeR</h4>

<p>Create only <strong>one instance</strong> of BadgeR!</p>

<p>Create BadgeR with definition file 'achievements.json' and i18n messages properties files starting with achievementsMsg (e.g.: achievementsMsg_en.properties):</p>

<div class="highlight highlight-java"><pre><span class="pl-k">final</span> <span class="pl-smi">InputStream</span> inStream <span class="pl-k">=</span> getClass()<span class="pl-k">.</span>getClassLoader()<span class="pl-k">.</span>getResourceAsStream(<span class="pl-s"><span class="pl-pds">"</span>achievements.ini<span class="pl-pds">"</span></span>);
<span class="pl-k">final</span> <span class="pl-smi">Badger</span> badger <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Badger</span>(inStream, <span class="pl-s"><span class="pl-pds">"</span>achievementsMsg<span class="pl-pds">"</span></span>);</pre></div>

<p>Or just with the definition file:</p>

<div class="highlight highlight-java"><pre><span class="pl-k">final</span> <span class="pl-smi">Badger</span> badger <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Badger</span>(<span class="pl-s"><span class="pl-pds">"</span>relative/path/to/definition/achievements.json<span class="pl-pds">"</span></span>);</pre></div>

<h4>
<a id="32-subscribe-for-badger-events" class="anchor" href="#32-subscribe-for-badger-events" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2 Subscribe for BadgeR events</h4>

<p>Subscribe for unlock events with a simple callback method.</p>

<div class="highlight highlight-java"><pre>badger<span class="pl-k">.</span>subscribeOnUnlock(<span class="pl-k">new</span> <span class="pl-smi">IAchievementUnlockedHandler</span>() {
    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onUnlocked</span>(<span class="pl-k">final</span> <span class="pl-smi">AchievementUnlockedEvent</span> <span class="pl-v">unlockEvent</span>) {
        <span class="pl-k">final</span> <span class="pl-smi">String</span> title <span class="pl-k">=</span> unlockEvent<span class="pl-k">.</span>getTitle(); <span class="pl-c">// localized title</span>
        <span class="pl-k">final</span> <span class="pl-smi">String</span> text <span class="pl-k">=</span> unlockEvent<span class="pl-k">.</span>getText();  <span class="pl-c">// localized description</span>
        <span class="pl-k">final</span> <span class="pl-smi">Integer</span> level <span class="pl-k">=</span> unlockEvent<span class="pl-k">.</span>getLevel(); <span class="pl-c">// unlocked level</span>
        <span class="pl-k">final</span> <span class="pl-smi">Date</span> acquireDate <span class="pl-k">=</span> unlockEvent<span class="pl-k">.</span>getAcquireDate(); <span class="pl-c">// unlock time stamp</span>
        <span class="pl-k">final</span> <span class="pl-smi">String</span> triggerValue <span class="pl-k">=</span> unlockEvent<span class="pl-k">.</span>getTriggerValue(); <span class="pl-c">// submitted value which unlocked the achievement</span>

        <span class="pl-c">// show achievement notification</span>
    }
});

badger<span class="pl-k">.</span>subscribeOnUnlock(<span class="pl-k">new</span> <span class="pl-smi">IScoreUpdateHandler</span>() {
    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onUnlocked</span>(<span class="pl-k">final</span> <span class="pl-smi">ScoreUpdatedEvent</span> <span class="pl-v">scoreUpdatedEvent</span>) {
        <span class="pl-k">final</span> <span class="pl-smi">String</span> event <span class="pl-k">=</span> unlockEvent<span class="pl-k">.</span>getEvent(); <span class="pl-c">// event name</span>
        <span class="pl-k">final</span> <span class="pl-smi">String</span> newValue <span class="pl-k">=</span> unlockEvent<span class="pl-k">.</span>getValue();  <span class="pl-c">// new value of event counter</span>

        <span class="pl-c">// update something ...</span>
    }
});</pre></div>

<p>with lambda expression</p>

<div class="highlight highlight-java"><pre>badger<span class="pl-k">.</span>subscribeOnUnlock(unlockEvent <span class="pl-k">-</span><span class="pl-k">&gt;</span> {
    <span class="pl-c">// show achievement notification</span>
} );

badger<span class="pl-k">.</span>subscribeOnUnlock(scoreUpdatedEvent <span class="pl-k">-</span><span class="pl-k">&gt;</span> {
    <span class="pl-c">// update something ...</span>
} );</pre></div>

<h4>
<a id="33-trigger-events" class="anchor" href="#33-trigger-events" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3 Trigger events</h4>

<p><strong>trigger simply</strong></p>

<p>Trigger an event and increment its counter by one.</p>

<div class="highlight highlight-java"><pre>@AchievementEventTrigger(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>myEvent<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">void</span> myMethod() {
    <span class="pl-c">// doesn't matter what the method do, only that it is called.</span>
}</pre></div>

<p>equivalent with </p>

<div class="highlight highlight-java"><pre>badger<span class="pl-k">.</span>triggerEvent(<span class="pl-s"><span class="pl-pds">"</span>myEvent<span class="pl-pds">"</span></span>);</pre></div>

<p><strong>Trigger with score</strong></p>

<p>Trigger an event and set the counter score with parameter annotation</p>

<div class="highlight highlight-java"><pre>@AchievementScore(counter <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>myEvent<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">void</span> myMethod(<span class="pl-k">final</span> @<span class="pl-smi">AchievementScoreParam</span> <span class="pl-smi">Long</span> newScore) {
    <span class="pl-c">// doesn't matter what the method do, only that it is called.</span>
}</pre></div>

<p>or in case of other Object arguments by giving the score getter method</p>

<div class="highlight highlight-java"><pre><span class="pl-c">// myObject.getMyScore(); - returns a Long</span>

@AchievementScore(counter <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>myEvent<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">void</span> myMethod(<span class="pl-k">final</span> @AchievementScoreParam(getter <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>getMyScore<span class="pl-pds">"</span></span>) <span class="pl-smi">MyObject</span> myObject) {
    <span class="pl-c">// doesn't matter what the method do, only that it is called.</span>
}</pre></div>

<p>equivalent with </p>

<div class="highlight highlight-java"><pre><span class="pl-k">final</span> <span class="pl-smi">Long</span> newScore <span class="pl-k">=</span> <span class="pl-c1">100L</span>; <span class="pl-c">// the new score to be set</span>
badger<span class="pl-k">.</span>triggerEvent(<span class="pl-s"><span class="pl-pds">"</span>myEvent<span class="pl-pds">"</span></span>, newScore);</pre></div>

<h4>
<a id="34-unlock-achievement-directly" class="anchor" href="#34-unlock-achievement-directly" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4 Unlock achievement directly</h4>

<p>Unlocked achievement directly by id. Optionally a trigger value will be stored only to provide information during unlock procedure.</p>

<div class="highlight highlight-java"><pre><span class="pl-c">// unlock single achievement with id 'achievementId'</span>
@AchievementUnlock(achievement <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>achievementId<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">void</span> myMethod1() {
    <span class="pl-c">// doesn't matter what the method do, only that it is called.</span>
}

<span class="pl-c">// unlock single achievement with id 'achievementId' and provide unlock information</span>
@AchievementUnlock(achievement <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>achievementId<span class="pl-pds">"</span></span>, triggerValue <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>special thing happened<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">void</span> myMethod2() {
    <span class="pl-c">// doesn't matter what the method do, only that it is called.</span>
}

<span class="pl-c">// unlock counter achievement with id 'achievementId' with value 10</span>
@AchievementUnlock(achievement <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>achievementId<span class="pl-pds">"</span></span>, triggerValue <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>10<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">void</span> myMethod3() {
    <span class="pl-c">// doesn't matter what the method do, only that it is called.</span>
}

<span class="pl-c">// unlock date achievement with id 'achievementId' with date value of 30th of January</span>
@AchievementUnlock(achievement <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>achievementId<span class="pl-pds">"</span></span>, triggerValue <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>01-30<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">void</span> myMethod4() {
    <span class="pl-c">// doesn't matter what the method do, only that it is called.</span>
}</pre></div>

<p>equivalent with </p>

<div class="highlight highlight-java"><pre><span class="pl-c">// unlock achievement with id 'achievementId'</span>
badger<span class="pl-k">.</span>unlock(<span class="pl-s"><span class="pl-pds">"</span>achievementId<span class="pl-pds">"</span></span>);

<span class="pl-c">// unlock achievement with id 'achievementId' and provide unlock information</span>
badger<span class="pl-k">.</span>unlock(<span class="pl-s"><span class="pl-pds">"</span>achievementId<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>special thing happened<span class="pl-pds">"</span></span>);

<span class="pl-c">// unlock achievement with id 'achievementId' with value 10</span>
badger<span class="pl-k">.</span>unlock(<span class="pl-s"><span class="pl-pds">"</span>achievementId<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>10<span class="pl-pds">"</span></span>);

<span class="pl-c">// unlock achievement with id 'achievementId' with date value of 30th of January</span>
badger<span class="pl-k">.</span>unlock(<span class="pl-s"><span class="pl-pds">"</span>achievementId<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>01-30<span class="pl-pds">"</span></span>);</pre></div>

<h4>
<a id="35-check-for-unlocked-achievements" class="anchor" href="#35-check-for-unlocked-achievements" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.5 Check for unlocked achievements</h4>

<p>Achievement check runs every time when an event is triggered. Nevertheless the checking can be done directly.</p>

<div class="highlight highlight-java"><pre>@<span class="pl-smi">AchievementCheck</span>
<span class="pl-k">public</span> <span class="pl-k">void</span> myMethod() {
    <span class="pl-c">// doesn't matter what the method do, only that it is called.</span>
}</pre></div>

<p>equivalent with </p>

<div class="highlight highlight-java"><pre>badger<span class="pl-k">.</span>check();</pre></div>

<h1>
<a id="enable-annotation-processing" class="anchor" href="#enable-annotation-processing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enable annotation processing</h1>

<p>To enable annotation driven features make sure you use AspectJ veawing.</p>

<p>Here is my maven example from my other project where I use BadgeR:</p>

<pre><code>&lt;plugin&gt;
    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
    &lt;artifactId&gt;aspectj-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.7&lt;/version&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
            &lt;artifactId&gt;aspectjrt&lt;/artifactId&gt;
            &lt;version&gt;1.8.5&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
            &lt;artifactId&gt;aspectjtools&lt;/artifactId&gt;
            &lt;version&gt;1.8.5&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;phase&gt;process-classes&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;compile&lt;/goal&gt;
                &lt;goal&gt;test-compile&lt;/goal&gt;  &lt;!-- for testing --&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
    &lt;configuration&gt;
        &lt;showWeaveInfo&gt;false&lt;/showWeaveInfo&gt;
        &lt;verbose&gt;true&lt;/verbose&gt;
        &lt;complianceLevel&gt;1.8&lt;/complianceLevel&gt;
        &lt;weaveDependencies&gt;
            &lt;weaveDependency&gt;
                &lt;groupId&gt;net.csongradyp&lt;/groupId&gt;
                &lt;artifactId&gt;badger&lt;/artifactId&gt;
            &lt;/weaveDependency&gt;
        &lt;/weaveDependencies&gt;
        &lt;aspectLibraries&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.aspectj&lt;/groupId&gt;
                &lt;artifactId&gt;aspectjrt&lt;/artifactId&gt;
            &lt;/dependency&gt;
        &lt;/aspectLibraries&gt;
        &lt;source&gt;1.8&lt;/source&gt;
        &lt;target&gt;1.8&lt;/target&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</code></pre>

<h2>
<a id="author" class="anchor" href="#author" aria-hidden="true"><span class="octicon octicon-link"></span></a>Author</h2>

<p><strong>Peter Csongrady</strong>
(<a href="csongrady.p@gmail.com">csongrady.p@gmail.com</a>)</p>

<p><a href="hu.linkedin.com/in/csongradyp">LinkedIn profile</a></p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
